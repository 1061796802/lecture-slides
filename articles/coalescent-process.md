---
title: "基因系谱与溯祖过程"
author:
  - "Richard R. Hudson"
  - "许颖"
  - "王强"
institute:
  - "University of Chicago"
  - "南京大学生命科学学院"
toc: true
...

# 引言

当我们比较一组同源的 DNA 序列时, 不同序列之间的相似样式通常含有关于这些序列进化历史的信息. 在广泛多样化的条件下,
序列数据提供多种信息, 包括: 哪些序列亲缘关系相对更近; 这些不同序列的最近共同祖先出现在多长时间之前.
如果这些序列取自不同的物种, 那么这些信息通常会以一个推断的系统发生树的形式提取或展示出来,
这个系统发生树可能显示了样本物种之间的进化关系. 这些序列如果不是取自不同的物种, 而是取自同一群体内的不同的个体,
那么信息就是谱系的, 在这种情况下, 可以推测出基因树. 一个基因树显示了样本序列中哪些序列的亲缘关系更近,
以及这些序列的最近共同祖先出可能现在什么时候. 一个假设有五个序列的样本的基因树或者系谱图如图 1 所示. 在没有重组的情况下,
每一个序列在上一代有一个单独的祖先. (这对于区分一个二倍体个体样本的世系和样本序列的基因树来说很重要,
因为在基因树中沿着一个祖先向前追溯, 而二倍体个体有两个亲本.) 随着样本基因详细系谱信息的获得成为可能,
分子群体遗传学的地位得到了显著的改变.

![五个等位基因的系谱举例, 显示了溯祖事件间的时间间隔. 图中, 时间间隔, $T(j)$, 用和方程 5 所给出的期望值成比例的长度表示出来](coalescent-process.images/image1.png)

在 DNA 时代以前, 分子多样性数据主要是以同功酶频率的形式, 用在电泳凝胶上的迁移率来区分基因. 通过蛋白电泳,
一个基因的两个同源拷贝可以分类为相同或不同. 如果它们是不同的, 不能衡量有怎样的不同; 如果这两个拷贝是相同的,
我们不能确信它们是真的相同还是某些物理性质的简单集合导致了电泳迁移率的相似. 因此,
我们不能从电泳频率的数据中获得基因系谱的详细细节信息. 运用现代 DNA 技术, 得到了很多个体同源区域的序列,
并且能据此得到关于样本基因系谱的详细信息. Stephens 和 Nei(1985), Aquadro 等 (1986) , Berminghan 和 Avise
(1986) , Avise 等 (1987), Cann 等 (1987) 给出了从样本基因推断系谱的例子.

对于分子群体遗传学来说, 一个显而易见的挑战就是: 怎样利用这些信息来增加我们对作用于自然群体的分子多样性的这些力量的理解?
从理论的角度, 我们可以从考察那些基于多种群体遗传模型的系谱的性质开始. 问这样一个问题很重要:
在不同竞争模型下的系谱应该很不相同吗? 我们可以设计出不同系谱所需的统计实验吗? 为了把这个任务进行下去,
需要检验样本基因系谱在不同模型下的统计性质.

接下来, 我将要描述通过分析法或者计算机模拟得到系谱性质的多种情况. 这不是关于基因系谱理论的综述,
只是关注无限位点模型的个人看法. 将在中性选择模型下描述系谱的一些性质, 有或没有重组, 有或没有地理结构.
一些形式的选择造成的影响也会涉及到.
我将会指出一些用这种系谱途径完成统计学测验或估算参数或简单观察测验观察值对数据的拟合性的方法.
我也将指出怎样建立基于溯祖过程的模拟和应用于研究多种模型.

这将不是一个严密的数学推导处理. 如果谁对更为精确的推导分析感兴趣, 可以查阅 Kingman (1980,1982a,b)
的对以后发展有巨大影响的论著和 Tavare (1984) 的综述. Griffiths (1980), Watterson (1984) 和 Padmadisatra
(1987,1984) 有很多关注无限基因模型的溯祖和 lines of descent 的工作, 本文没有包括这些简洁有用的工作.
本文囊括很多了关于等位基因时间的工作 (Donnelly 1986; Donnelly 和 Tavare1986; Tavare 等 1989).
无限等位基因模型和无限位点模型是紧密相关的, 之后会讨论到, 其中一个的结果常常可以用来回答关于另一个的问题. 但是,
这两个模型提出的问题和关心的参数值通常是截然不同的. 我把注意集中在直接与无限位点模型相关的结果上,
我认为无限位点模型对于解释群体中的核苷酸多样性是最有用的.

我将关注于相对小的样本等位基因的性质. 对于那些关于整个群体的系谱性质的工作, 包括固定时间, 将不予考虑 (Donnelly 和
Tavare 1987; Watterson 1982a, 1982b). 并且, 关于基因树和物种树之间关系的重要工作也不会讨论到 (Hudson 1983b,
Neigl 和 Avise 1986; Pamilo 和 Nei 1988; Takahata 1989). 系谱的统计性质强烈依赖于样本的上一代形成下一代的种类.
在这一章中, 只讨论 Wright--Fisher (W--F) 模型. 这个模型下上一代产生下一代的模式将在下一个部分中简要描述.
一系列可选择的中性模型被发现本质上有和 W--F 模型相同的系谱性质, 只需要改变时间标度即可 (Kingman 1982a,b; Watterson
1975; Tavare 1984 review; Ewens 1989 review).

# 不考虑中性突变过程的系谱过程

下文中要详细讨论的是: 依赖群体大小, 地理结构和选择性保留基因的出现等因素的系谱性质.
很明显系谱的性质应该依赖于这些人口统计学的性质, 因为实际的系谱依赖于谁有后代而谁没有, 谁迁移了, 迁移去了哪里,
谁的后代含有不普遍的重要突变. 也很明显, 绝对中性的突变 --- 没有和将不会对适合度有影响的突变 ---
应该对随机交配样本的系谱没有影响. 这是因为, 根据定义, 中性突变不影响含有这些突变的个体的后代数或者迁移趋势. 情况既然这样,
在研究这些系谱性质时就可以不考虑中性变种具体的突变模型. 所以, 举例来说,
系谱的统计性质不依赖于中性突变是否在迁入者中比在迁出者中更频繁, 或者无限位点, 有限位点还是无限等位基因模型中哪个最合适.
当然, 我们关于系谱过程的推理的统计学性质好像强烈依赖于突变过程. 比如, 如果中性突变的频率很低,
样本中的所有序列可能是相同的, 我们就得不到关于样本系谱的信息.


我们考虑中性突变过程, 每个后代相对于亲本的突变的位点数符合泊松分布. 突变数的平均值 $\mu$ 认为是常数, 不依赖于基因型,
群体大小和时间. 认为突变在不同个体和不同代之间独立发生. 这个突变过程被成为是恒定突变率的中性突变过程.
这是标准的中性突变模型 (Kimura 1983; Watterson 1975). 在这些假设下,
沿着世系以不变的方式积累的突变不依赖诸如群体大小, 时间和连锁位点的选择事件等因素. 假设 $t$,
从共同祖先到两个同源样本序列的世代数, $S$, 向下到这两个派生的序列过程中产生的突变数, 是泊松分布的, 有平均值 $2 \mu t$.
当 $t$ 是一个随机变量时, 假设是恒定突变率的中性突变过程, 平均数和方差 --- 实际是 $S$ 的所有瞬间值 --- 都是由时刻 $t$
决定的.

为了强调这一点, 考虑一个群体的某一位点在 0 时刻是完全纯合的, 并且这一位点只发生中性突变. $t$ 代进化之后,
在一个随机取样的个体中检验这一位点. 在我们上一段描述的突变方案之下, 区分我们随机取样的这个个体和 0
时刻时群体中的个体所发生的突变数就是在 $t$ 这段时间内沿着一个特定世系发生的突变数. 突变数是呈泊松分布的, 有平均值 $\mu
t$. 不论群体大小是多少, 连锁位点是否发生选择, 或者群体是否发生分化. 这是 Birky 和 Walsh (1988)
关于连锁位点发生选择时中性突变积累率的结果的基础. 在以上的例子中, 在 0 到 $t$
时间里固定在整个群体中的突变数要依赖于群体大小和人口统计学方面. 同样地, $t$
时刻群体中的多态性依赖于群体大小和其他人口统计学方面, 但是在过去的 $t$ 代的时间里,
沿着某个特定世系发生的突变这使得一个取样的序列不同于它 $t$ 代之前的祖先, 不考虑其他因素, 突变数量是呈泊松分布的, 有平均值
$\mu t$.

在以下的途径中, 恒定突变率的中性突变过程的作用将会迅速扩大. 令 $T_{tot}$ 代表一个样本的系谱的所有分支长度的总和.
在上段中讨论的, $S$, 系谱上突变的数量是泊松分布的, 给定 $T_{tot}$, $S$ 有平均值 $\mu T_{tot}$. 一旦 $T_{tot}$
的分布在一定的模型下被确定, 很容易得到 $S$ 的分布. 比如说, 如果 $T_{tot}$ 起初的两个时刻能确定, 那么 $S$
起初的两个时刻能够根据符合分分布的性质计算出来:

\begin{equation*}
    E(S)=\mu E(T_{tot})
\end{equation*}

和

\begin{equation*}
    \text{Var}(S)=\mu E(T_{\text{tot}})+\mu ^{2}\text{Var}(T_{\text{tot}})
\end{equation*}

重申, 在我们将要讨论的模型之下, 系谱的性质不依赖于中性突变过程, 因此可以在不准确说明中性突变过程的情况下来研究. 比如说,
我们可以不确定中性突变率或突变模式来研究 $T_{\text{tot}}$ 的统计学性质. 此外,
样本中中性变异的统计性质完全由系谱的统计性质和中性突变过程来决定. 也就是说, 如果两个不同的模型有相同的中性突变过程假设,
并且如果这两个模型有相同的系谱分布, 那么这两个模型的中性变异模式就是相同的. 比如说, 如果中性突变模式如我们前面所描述的,
$S$ 的平均值完全由 $T_{\text{tot}}$ 的平均值决定. 两个不同的模型如果有相同的 $T_{\text{tot}}$ 平均值,
那么就有相同的 $S$ 平均值.

在这一章, 我们会考虑一个理想的单倍体或者二倍体的 W--F 模型. 简言之, 这是一个分离世代的模型, 从单倍体角度, $N$
次取样得到的 $N$ 个子一代单倍体个体 (并且复制可能有突变) 取代亲本一代. 在选择中性的角度, 所有亲代个体有相同可能性作为子代
$N$ 个单倍体个体的亲本. Ewens (1979) 中有这个模型的详细描述. 我们假设 $N$ 很大并且恒定,
在这种情况下个体的后代数目近似于泊松分布. 关于这个模型的大多数结果都是近似的, 和 $1/N$ 相比忽略 $1/N^{2}$ 项.
这和通常对扩散近似所做的假设一致, 并且称作扩散近似. 与 W--F 模型相比, Moran 模型通常能得到精确结果 (见 Watterson
1975). 这里不讨论 Moran 模型.

# 最简单的情况: 没有选择也没有重组

尽管系谱过程在很多已经进行了多年的工作中是不言明的, 但它是关于遗传材料和得到那些激励直接考虑系谱过程的早期工作的序列数据 (或
restriction map 数据) 可能性的本质的知识. Watterson (1975) 引人注目的论文描述了中性模型下系谱的基本性质,
并且标志着现代溯祖理论的开始. 下面关于 W--F 中性模型下非重组系谱的描述大量引自 Watterson (1975), Kingman
(1980,1982a,b), Griffiths (1980) 和 Tajima (1983) 的工作.

首先, 我们考虑一个理想的单倍体物种, 没有重组, 没有地理分化, 没有选择, 一个典型的普通单倍体物种.
我们希望检验从这一群体中随机取样的 $n$ 个个体的系谱性质. 让我们把从群体中取样的时刻标记为 0 代. 从时间上向前回溯 $t$
代的祖先群体称作 $t$ 代.

从这样一个群体中取得的样本的基本性质关系到概率 $P(n)$, $n$ 个取样个体在上一代有截然不同的祖先的概率,
之后的叙述都在这些性质的基础之上. 首先考虑两个个体的样本. 第二个个体和第一个个体有相同亲本的可能性是 $1/N$, 因为在中性
W--F 模型下, 上一代的每一个个体有相同的可能性成为现一代任何一个个体的亲本. 因此 $P(2)$ 是 $1-1/N$.
如果样本含有三个个体, 这三个个体在上一代有不同亲本的可能性就是前两个个体有不同亲本的概率 $\times$
第三个个体和前两个个体没有共同亲本的概率. 有 $N-2$ 个个体是不同于前两个取样个体的亲本的个体,
因此假设前两个个体有不同的亲本, 第三个个体有不同于前两个个体的亲本的概率是 $(N-2)/N=1-2/N$. 总得来说, $n$
个样本个体在上一代有 $n$ 个不同亲本的概率是:

\begin{equation*}
    P(n) = \overset{n-1}{\underset{i=1}\prod }(1-i/N) \approx 1-\frac{\binom{n}{2}}{N}
\end{equation*}

我们可以对 $n$ 个不同的祖先问相同的问题: 它们在前一代有 $n$ 个不同祖先的概率是多少? 很清楚, 还是 $P(n)$. 这意味着 $t$
代之内 $n$ 个样本个体在之前一代有 $n$ 个不同的祖先, 在向前回溯的 $t+1$ 代有两个或更多个体有共同祖先的概率是:

\begin{equation*}
    P(n)^{t}[1-P(n)] \approx \frac{\binom{n}{2}}{N}e^{-\frac{\binom{n}{2}}{N}t}
\end{equation*}

用文字说明就是, 向前追溯到第一个共同祖先出现的时间是呈几何分布的, 并且近似于一个指数分布, 有平均值 $N/\binom{n}{2}$.
对于很大的 $N$ 和很小的 $n$, 如我们通篇假设的, 样本中两个以上个体在同一代里有共同祖先的概率是很小的, 可以被忽略.
因此很可能, 在样本的近期历史中, $t$ 代里存在 $n$ 个不同的世系, 在 $t+1$ 代, 两个样本个体的一对世系 ``溯祖''
到了一个最近的共同祖先. 在系谱图上表现为两个世系所代表的分支 ``接合'' 在一个点. 每一个可能的 $\binom{n}{2}$
世系对都有相同的可能性成为找到共同祖先的一对. 继续向前追溯样本的历史, 我们注意在第一次接合的那一代的上一代, 有 $n-1$
个祖先或者说世系可以继续向前追溯. 在每一代中所有祖先在上一代有不同祖先的可能性是 $P(n-1)$.
所以到下一次接合的时间近似指数分布, 平均值是 $N/\binom{n-1}{2}$. 在这个接合, 每一个可能的 $\binom{n-1}{2}$
世系对都有相同的可能性在这一点接合. 注意, $(n-1)$ 个世系中的一个在我们起初的样本中有两个后裔, 其他的世系有一个.
我们可以按照这种方式继续下去, 直到所有世系接合到一个世系, 样本里全部的 $n$ 个个体的共同祖先.

如图 1 中所示的五个样本等位基因的系谱. 产生一个谱系的随机过程, 被称为溯祖过程, 可以简要概括出来. $T(j)$, 有 $j$
个不同世系的时间近似呈指数分布, 如果以 $N$ 代为单位衡量时间, $T(j)$ 的平均值是:

\begin{equation*}
    \mathrm{E}[T(j)]=\frac{1}{\binom{j}{2}}
\end{equation*}

在 $t$ 代所有世系中随机选择的两个世系在 $t+1$ 代接合在系谱图的一个节点. 注意, 我们没有关心我们样本的祖先之外的世系.
也要注意, 接合之间的时间间隔 $T(j)$ 互不依赖. 并且, 需要指出系谱图上老的部分 (图 1 中系谱图的上一部分)
与小样本系谱图在统计学性质上是相同的. 比如说, 样本数为 $n$
的样本的历史中系谱图上第一个最近共同祖先以上部分的分布与样本数为 $n-1$ 的样本是完全相同的.
在计算机中生成这样的系谱是没有意义的. (附录中给出了一个程序的例子) .

这些系谱性质可以用于普通的单倍体生物, 也可以用于线粒体基因组. 如果线粒体遗传是严格母系的并且母本个体内的多态性是可以忽略的,
$N$ 的值就是母本的数目.

对于 $N$ 个二倍体个体的大群体, 在随机交配的 W--F 模型下, 没有重组和选择, 结果也是一样, 只是要用 $2N$ 代替 $N$.
这种情况下, 系谱应该被想成是没有重组的特定位点的系谱. 这些位点可能含有一个核苷酸位点, 或者, 如果重组率十分低,
很多可以认为是完全连锁的相邻核苷酸位点. 按照正在考虑的模型, 十分低意味着 $Nr\ll 1$, 其中 $r$
是每一代所关心的区域两端之间的重组率. 如果在单倍体模型中以 $N$ 代为单位衡量时间, 在二倍体模型中以 $2N$ 代为单位衡量时间,
单倍体和二倍体的结果是完全相同的, 即 $T(j)$ 由公式 (5) 给出.

在大的群体中不连锁的位点在本质上是独立的, 有各自独立的系谱. 连锁的位点, 有先关的位点, 之后会考虑到.

# 系谱中加入中性突变

假设有我们刚刚讨论的系谱性质, 我们可以预言各种各样突变下的样本的性质. 如之前部分所讨论的,
我们假设一个恒定突变率的中性突变过程, 其中每一个子代配子相对于亲本的突变个数平均值为 $\mu$. 另外, 我们假设一个无限位点模型
(Kimura 1969). 在这个模型下, 基因座由很多位点组成, 所以在我们的样本系谱中每个位点发生的突变不多于 1 个.
没有采用的无限等位基因模型 (Kimura 和 Crow 1964) 是相似的, 假设每个突变产生一个不存在于样本系谱其他任何地方的新基因.
对于我们的目的, 无限等位基因模型和无限位点模型在本质上是相同的, 但是在无限等位基因模型下会忽略多少个突变区分等位基因,
并且只注意到等位基因是否相同.


我们关心的首要性质是关于发生在一个样本的系谱分支上的突变的个数的分布. 在无限位点模型下,
突变的个数和样本中有多态性的核苷酸位点的数目是相同的. $S$ 代表样本中多态性位点的数目, 常常被说成是样本中的分离位点
(segregating sites). 首先, 我们考虑 $S$ 的期望值.

从方程 (1) 我们可以从系谱的总长度 $T_{\text{tot}}$ 的期望计算 $S$ 的期望. 从 $T(j)$
的定义很容易知道系谱分支的总长度是 $\overset{n}{\underset{i=2}\sum }iT(i)$. 因此, 以 $2N$ 为单位衡量时间, 从方程
(5) 可得到:

\begin{equation*}
    E(S)=\frac{\theta}{2}\overset{n}{\underset{i=2}\sum }iE(T(i)) = \theta \overset{n-1}{\underset{i=1}\sum }1/i
\end{equation*}

其中 $\theta = 4N \mu$ (Watterson 1975). 总时间的方差也很容易得到, 用方程 (2) 和 (6) , 得到 (Watterson
1975):

\begin{equation*}
    \text{Var}(S) = \theta \overset{n-1}{\underset{i=1}\sum }\frac{1}{i} + \theta ^{2}\overset{n-1}{\underset{i=1}\sum }\frac{1}{i^{2}}
\end{equation*}

实际上, 任何时刻的 $S$ 都可以用这一时刻的 $T_{i}$ 的形式表示. Watterson
也说明了分离位点的数目在足够大小的样本中是通常的近似分布的.


我们可以得到 $S$ 的总体分布, 但是首先我们考虑 2 个个体的样本 $S=0$ 的概率. 这和纯合的期望 $E(F)$ 是相等的,
或者这两个样本基因相同的概率. 这个概率可以从两个途径得到. 如果在无限位点模型 (或无限等位基因模型) 下两个样本基因是相同的,
就必须是在从最近共同祖先 (可用 MRCA 表示) 向下到它们的世系上没有发生突变的情况下. 假定 $t$
为回溯到它们的共同祖先的世代数, 从 MRCA 向下过程中没有发生突变的概率是 $\mathrm{e}^{-2\mu t}$.
这从突变的泊松假设可以得到. 因此, 如果我们得到期望 $\mathrm{e}^{-2\mu t}$, 在 $t$ 的分布之上, 我们得到:

\begin{equation*}
    E(F)=E(\mathrm{e}^{-2\mu t})=\int _{0}^{x}\frac{\mathrm{e}^{-\frac{t}{2N}}}{2N}\mathrm{e}^{-2\mu t}dt=\frac{1}{1+\theta }
\end{equation*}

$t$ 是指数分布的, 在二倍体模型中有平均值 $2N$. 

这是一个经典结果 (Kimura 和 Crow 1964) , 当然可以用递归方法得到, 但是在这里需要知道它和系谱的联系. 

方程 (8) 也举例说明了无限等位基因模型和溯祖过程之间的联系. 对于群体过程的任何一个决定系谱过程的模型,
如果突变过程是我们已经假设的无限等位基因恒定突变率中性突变过程, 两个随机取样的等位基因相同的概率是 $C(\theta
)=E(\mathrm{e}^{-\theta t})$, 其期望和 $t$ 的分布有关, $t$ 是以 $2N$ 代为单位衡量的两个随机等位基因回溯到 MRCA
的时间. 相同性系数以 $-\theta$ 为参数, $C(-\theta )$ 也是 $t$ 的矩量母函数 (moment generating function) .
瞬时的 $t$ 以及相应的瞬时 $S$ , 很容易用标准方法从 $C(\theta )$ 得到. 比如说, $E(t)$ 是 $–C'(0)$, $E(S)$ 是
$–\theta C'(0)$, 其中 $–C'(0)$ 代表 $-C(\theta )$ 的导数, 取 $\theta = 0$. 这很一般的. 比如说,
在多基因家族中保守的基因模型下, 一对取样的等位基因的相同性系数已经从多种途径得到 (Nagylaki 和 Petes 1982) .
只要用相同性系数的导数来描述, 在无限位点模型下区分这些等位基因的瞬时位点数目就可以计算.

方程 (8) 的一个导数包括两个取样基因在时间上向前追溯的历史, 直到找到这两个等位基因的 MRCA
或者找到了其中一个世系上的一个突变. 在每代, MRCA 出现的概率 $P_{\text{CA}}$ 是 $1/2N$. 同样, 在每一代,
两个世系中的某一个发生突变的概率 $P_{\text{mut}}$ 是 $2\mu$. 当且仅当先遇到的时间是一个共同祖先时,
这两个等位基因才可能相同. 假定这两个事件中的某一个发生了, 并且忽略这两个事件在同一代发生的概率,
先遇到的事件是共同祖先的概率是:

\begin{equation*}
    E(F)\approx \frac{P_{\text{CA}}}{P_{\text{CA}}+P_{\text{mut}}}=\frac{1/2N}{1/2N+2\mu }=\frac{1}{1+\theta }
\end{equation*}

同样的方式, 可以得到 2 个个体的样本到共同祖先所发生的突变数目的总体分布. $P_{2}(j)$, 从 MRCA 开始 $j$
个突变发生在世系上的概率, 就是起初的 $j$ 个事件是突变、第 $(j+1)$ 个事件是一个共同祖先的概率. 因此, 我们有
(Watterson, 1975):

\begin{equation*}
    P_{2}(j)=(\frac{\theta }{1+\theta })^{j}\frac{1}{1+\theta }
\end{equation*}

用同样的理由, 我们可以得到有 $n$ 个祖先世系时发生 $j$ 个突变的概率 $Q_{n}(j)$. 得到 $j$ 个突变的这段时间, 有 $n$
个世系, 前 $j$ 个事件必须是突变, 第 $(j+1)$ 个事件必须是共同祖先. 因此, 概率是:

\begin{equation*}
    Q_{n}(j)=(\frac{n\mu }{n\mu +\frac{(\binom{n}{2})}{2N}})^{j}\frac{\frac{(\binom{n}{2})}{2N}}{n\mu +\frac{(\binom{n}{2})}{2N}}=(\frac{\theta }{\theta +n-1})^{j}\frac{n-1}{\theta +n-1}
\end{equation*}

大小为 $n$ 的样本中分离位点的数目是 $n$ 个世系时发生的个数和系谱中剩余部分发生个数的加和, 在其他部分的分布如同一个大小为
$n-1$ 的样本. 大小为 $n$ 的样本中有 $j$ 个分离位点的概率 $P_{n}(j)$ 可以写作:

\begin{equation*}
    P_{n}(j)=\overset{j}{\underset{i=1}\sum }P_{n-1}(j-1)Q_{n}(i)
\end{equation*}

分离位点个数的分布可以用这个递归公式很快计算出来. Tavare (1984)得到了 $P_{n}(j)$ 的一个明确的表达式. 图 2 显示了
$\theta =5$ 和 $n=20$ 的 $S$ 的分布. 

![在一个含有 20 个等位基因 $\theta = 4N\mu = 20$ 的样本中分离位点数 $S$ 的分布. 用方程 (12) 计算无重组 (no-recombination) 分布 ($\mathrm{R}=4N\mu =0$) . 对于 $R=20$, 分布是用文中所述的蒙特卡洛方法做 100000 个重复得到的一个估计. 两种分布中 $S$ 的期望值都是 17.7, 这个值可以用方程 (6) 计算出来.](coalescent-process.images/image2.png)

下面的例子说明了方程 (12) 的应用. 在最近一个果蝇黄色--无刚毛--鳞甲区域 (yellow--achaete--scute region of
\textit{Drosophila melanogaster}) 中多态性的调查中, 在所调查的 64 个染色体上的 2112 个核苷酸位点中发现了 9
个多态性位点 (Aguade et al. 1989). 从果蝇染色体组的其他区域估算每个碱基对的 $\theta$ ($\theta$ per base pair)
有平均值 0.005. Aguade 等想确定 9 个多态性位点的观察值是否符合黄色--无刚毛--鳞甲区域每个碱基对的 $\theta$ 是 0.005.
用方程 (12) , 我们可以计算 9 个或更小的多态性的概率, 在一个大小为 64 的样本中, $\theta = 2112(0.005) = 10.6$,
概率近似为 $2 \times 10^{-6}$. 假设中性平衡理论是正确的, 必须拒绝 0.005 作为这一区域的每个碱基对的突变参数值.
如果假设在这一区域发生了重组, 9 个多态性位点或更少的概率会更小.

# 搭乘效应

用溯祖方法, Kaplan 等 (1989) 分析了一个模型, 其中罕见的有利突变横扫整个群体.
他们再分析了连锁位点上优势变异的选择性突变的搭乘效应(Maynard Smith 和 Haigh1974). 这个过程很像平衡选择模型,
除了选择基因的频率随时间改变, 因而溯祖事件的概率, 和其他事件一样, 随时间改变. 因此, 事件之间的时间间隔不再是指数分布的.
如果有利基因的频率能用一个确定的函数近似表示, 结果可以用直接的数值方法得到. 用这种方法,
可以估算连锁的核苷酸位点上的中性变异被一个有利突变的快速固定减少了多少.

图 10 显示了一个系谱图, 举例证明了一个基因树的形状在一个近期的搭乘事件后与平衡中性突变模型的系谱 (图 1) 相比有多不同. 图
10 中的大多数包含了没有向下分支出一个单独取样配子的世系. 用这个系谱模式, 一个 ``星形'' 系谱, 多数中性突变会导致多态性,
在每个多态性位点, 突变核苷酸只被替换一次并且没突变的核苷酸在所有子代序列中出现. 就是说,
大多数核苷酸位点将会有一个低频率等位基因, 在样本中出现一次或者两次, 和一个非常高频的等位基因.
没有一个特定的配子会带有大量稀有的突变, 但是可以期望有一个高度差异的世系.
这个主要是低频多态性的模式特有的是一个近期重度的瓶颈之后的群体, 这个瓶颈导致了大多数世系在一个相对短的时期内追溯到共同祖先
(coalescent) . 和搭乘模型相比, 一个群体瓶颈之后, 所有基因座可以预计有与众不同的系谱.
多态性的频谱可以证明是核苷酸多态性的一个特别有用的特征.

![当一个选择上有利的突变刚刚固定时的一个含 6 个等位基因的样本的系谱图举例. 黑体的曲线显示了有利突变的频率作为时间的函数. 样本在 $t_{\mathrm{s}}$ 时刻的系谱在函数上叠加表示出来. 例子中没有描述重组. 如果 $t_{\mathrm{s}}$ 显著小于 $N$, 多数溯祖事件会发生在接近 0 时刻处. 在这种情况下, 和没有选择的系谱相比, 系谱的总体大小将会是小的, 因此将会有相对少的变异. 同样, 系谱的形状和中性平衡的系谱不同](coalescent-process.images/image10.png)

# 结语

聚焦溯祖过程是在多样的情况下考虑样本性质的一种有用方法. 我们可以看到, 在多样的情况下, 能够相对容易地描述溯祖过程.
加上上一章中描述的情况, 溯祖过程已经被用于检验有基因转换的多基因家族中基因的变异 (Kaplan 和
Hudson1987；Watterson1986b) , 以及转座子家族 (Hudson 和 Kaplan1986b) 、高度重复分散元件, 如 ALU (Kaplan 和
Hudson1987) . 在这里叙述的很多分析, 系谱的总体复杂性简化成一或两个统计量, 即系谱有多大, 或者等效地,
预计有多少突变在系谱上发生. 某些情况下, 也可以问取自一个亚群体或某个选择性存在的基因类的样本的系谱有多大,
或者不同类别或等位基因有多少核苷酸分歧. (对所有含有特定电泳等位基因序列二次取样也能得到系谱大小: Hudson 和
Kaplan1986a) . 值得注意的是这些性质常常从经典方法得到, 没有准确提及样本的系谱, 用一代递归或者扩散方法(Watterson
1989a). 但是系谱方法直观、清楚, 提供了一个普遍的方法来得到结果和设想很多模式下预期的变异样式. 对于没有重组的的区域,
系谱是概括复杂信息的有效途径, 经验的和理论的, 如 Avise 等 (1987) 和 Cann 等 (1987) 在线粒体变异方面的工作所例证的.

利用样本系谱实际数据的方法, 与仅仅用\textit{S}相反, 可能在某些情况下特别有效. 引人注目的是 Golding(1987; Golding 等
1986)和 Iizuka(1989)的工作, 为了查明选择而检验了系谱上不同种类的突变的分布. Slatkin(1989)和 Slatkin 和
Maddison(1989)已经开始探索用详细的系谱信息推断地理结构的方法.
用无根树形式的详细系谱信息对突变参数的估算已经被仔细检查过(Strobeck 1983). 样本等位基因的系谱上有大量的信息.
探究这些信息的额外的方法是需要的.

对于重组水平高的区域, 详细的系谱也许不可能有任何可靠性的推断. 对于核基因, 相距几百碱基对的位点的系谱可以显著不同.
我们推理一个几百个碱基对的片段的系谱的能力是非常有限的.
中等长度序列的样本的系谱常常会是一个难以置信复杂的世系、溯祖过程和断裂的网络.

尽管至少中等水平的重组下某种系谱信息可能存在 (Golding 1987), 但当分析高度重组区域的数据时概要的统计量可能是非常重要的,
而不是详细的系谱重建. 可能有用的量包括多态性水平 (用 $S$ 或平均差异对数来衡量) , 变异频谱,
和不同种类的变异之间的这些量的对比, 比如沉默的和编码的、插入/缺失和替换或者和不同电泳等位基因相关的变异. Sawyer
等(1987)用了这样一种方法. 物种内可见的模式和物种间观察到的模式之间的比较将会提供大量信息(Kreitman 1987),
建议平衡选择位点、搭乘事件, 或者发生了突变率或约束条件的剧烈改变.
十或十五个有酶多态性的位点可能可以用和\textit{Adh}相同的方式有效地检测. 对于在各种模型下得到这些量的一些统计学性质,
溯祖过程是有用的. 毕竟应用于单个位点系谱的无重组分析忽略了有多少重组发生. (如果每一个核苷酸位点的突变率足够低,
无限位点或无限等位基因模型对于单核苷酸位点仍是准确的. 对于高突变率, 可能需要有限等位基因模型. ) 但是,
充分考虑到连锁位点的非独立性, 可能证明了用任何方法都非常困难, 不论经典的或溯祖的. 处于这个原因,
基于溯祖过程的模拟将会在统计学方法、试验和评估的研究中扮演重要的角色.

考虑无重组模型的惯例, 和蒙特卡洛 (Monte Carlo) 模拟一起, 可能是分析种内分子变异的方法发展的重要路线.
基于有重组溯祖过程的模拟是重要的秩序, 比执行过时的在计算机里重现整个世代的相似模拟和费时的取样产生连续世代的大数量更快捷.
模拟的方法可以直接地合并, 同时地, 重组, 地理结构, 群体大小变异和不平衡情况, 还有环形染色体组和选择形式, 和各种突变方案.
这种模拟将在建立估计量的置信区间, 统计试验的显著点, 和依靠各种可供选择的模型的试验的效力上发挥作用.

尽管分析来着重组 DNA 的数据有困难, 但是这些数据在某些情况下可能是首选的. 考虑一个整个分子有一个单独系谱的线粒体样本,
因为没有重组. 因为线粒体基因组中含有大量位点, 可以希望能准确推断系谱.
但是得到的系谱是对控制所取样群体的分子进化的随机过程的单一认识. 从一次观察中得到的对于随机过程推断的自信是有限的.
对于核基因组, 我们常常不能准确推断系谱, 因为不同程度的统计学独立性. 每一个片段将会经历与亚群体和群体大小一样的历史.
如果有这种能帮助我们估算参数或检验假说的样本统计学性质, 积累不同位点的信息的可能性使得核基因组潜在地能提供更多信息.
比如说估算迁移率和突变参数, 用核基因可能更精确.
用于检验\textit{Adh}内部或附近变异的分析类型可能不能仅仅用线粒体数据实现. 但是可以用 Hudson 等 (1978) 的检验, 用
mtDNA 作为一个基因座, 核基因作为另一个基因座.

中性模型和恒定选择系数的某种模型下预期的系谱在一定程度上已经描绘出来. 一类不能预测系谱的重要的模型是随机环境模型. 重要的是,
是否这些模型预测的系谱进而中性模型预测的系谱很不相同.

群体内的 DNA 多态性已经从它们应对关于群体内遗传变异的长期问题的有效性上显示出来. 随着更多数据被收集,
很明显系谱分析将会参与理解已经显露出的那些模式.

# 名词

* 溯祖过程 (coalescent process)

* 无限位点模型 (infinite-site model)

* 无限等位基因模型 (infinite allele model)

* 搭乘效应 (Hitchhiking) 

\begin{equation*}
    \pi
\end{equation*}
